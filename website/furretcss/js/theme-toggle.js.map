{"version":3,"sources":["furretcss/js/theme-toggle.js"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","Array","from","isArray","_arrayLikeToArray","_createForOfIteratorHelper","o","allowArrayLike","it","length","i","F","s","n","done","value","e","_e","f","err","normalCompletion","didErr","call","step","next","_e2","minLen","Object","prototype","toString","slice","constructor","name","test","len","arr2","window","furrets","USER_OVERRIDE","noop","storage","result","uid","Date","localStorage","setItem","getItem","removeItem","exception","console","log","acceptedHostnames","DOMRegex","elem","attr","regex","_step","output","_iterator","document","querySelectorAll","link","url","includes","location","hostname","URL","origin","pathname","push","loadColorScheme","scheme","links","furretcssPath","RegExp","apply","furretcssHljsPath","_i","_links","href","rel","min","concat","protocol","matchMedia","matches","themeToggle","toggleBtn","themeToSet","innerText","addThemeToggle","storedTheme","createElement","className","addEventListener","querySelector","insertAdjacentElement","loadedTheme","split","pop","themeToPreload","preload","replace","as","after","warn"],"mappings":"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","file":"theme-toggle.js","sourcesContent":["window.furrets = window.furrets || {};\nwindow.USER_OVERRIDE = window.USER_OVERRIDE || {};\n\nconst noop = () => {};\n\nvar storage = (function () {\n\tvar uid = new Date();\n\tvar storage;\n\tvar result;\n\ttry {\n\t\t(storage = window.localStorage).setItem(uid, uid);\n\t\tresult = storage.getItem(uid) == uid;\n\t\tstorage.removeItem(uid);\n\t\treturn result && storage;\n\t} catch (exception) {\n\t\tnoop();\n\t}\n\tstorage = function () {\n\t\tconsole.log('localStorage Disabled.');\n\t\treturn;\n\t};\n\tstorage.getItem = function () {\n\t\tconsole.log('localStorage Disabled.');\n\t\treturn;\n\t};\n\tstorage.setItem = function () {\n\t\tconsole.log('localStorage Disabled.');\n\t\treturn;\n\t};\n\treturn storage;\n})();\n\nconst acceptedHostnames = window.USER_OVERRIDE.acceptedHostnames\n\t? window.USER_OVERRIDE.acceptedHostnames\n\t: [\n\t\t\t'css.furret.dev', // production server\n\t\t\t'furretcss-lib.rayhanadev.repl.co', // development server\n\t  ];\n\n/*\n * @internal\n * Source: {@link https://stackoverflow.com/questions/16791527/can-i-use-a-regular-expression-in-queryselectorall}\n */\nconst DOMRegex = function (elem, attr, regex) {\n\tconst output = [];\n\tconst elements = document.querySelectorAll(elem);\n\n\tfor (const link of elements) {\n\t\tconst url = acceptedHostnames.includes(location.hostname)\n\t\t\t? new URL(link[attr], location.origin) // use website hostname (self-hosting)\n\t\t\t: new URL(link[attr]); // use link hostname (cdn)\n\n\t\tif (regex.test(url.pathname)) {\n\t\t\toutput.push(link);\n\t\t}\n\t}\n\n\treturn output;\n};\n\n/*\n * @internal\n */\nconst loadColorScheme = function (scheme) {\n\tif (!['light', 'dark'].includes(scheme)) scheme = 'light';\n\n\tconst links = [];\n\n\tconst furretcssPath = new RegExp(\n\t\t'/furretcss/v2/full/(?:light|dark)(?:.min)?.css',\n\t);\n\n\tlinks.push(...DOMRegex('link', 'href', furretcssPath));\n\n\tconst furretcssHljsPath = new RegExp(\n\t\t'/highlightjs/(?:light|dark)(?:.min)?.css',\n\t);\n\n\tlinks.push(...DOMRegex('link', 'href', furretcssHljsPath));\n\n\tfor (const link of links) {\n\t\tconst url = acceptedHostnames.includes(location.hostname)\n\t\t\t? new URL(link.href, location.origin) // use website hostname (self-hosting)\n\t\t\t: new URL(link.href); // use link hostname (cdn)\n\n\t\tif (!acceptedHostnames.includes(url.hostname)) continue;\n\n\t\tif (link.rel === 'stylesheet') {\n\t\t\tif (link.href.includes('/furretcss/v2/full')) {\n\t\t\t\tconst min = link.href.includes('.min') ? '.min' : '';\n\t\t\t\tlink.href = `${url.protocol}//${url.hostname}/furretcss/v2/full/${scheme}${min}.css`;\n\t\t\t}\n\n\t\t\tif (link.href.includes('/highlightjs')) {\n\t\t\t\tlink.href = `${url.protocol}//${url.hostname}/highlightjs/${scheme}.css`;\n\t\t\t}\n\t\t}\n\t}\n};\n\n/*\n * Side effect of loading the file. Sets up first interaction states\n * and sets localStorage keys. Does not activate theme, use\n * furrets.addThemeToggle() to do that.\n */\nif (storage.getItem('furretcss-interacted') !== 'true') {\n\tif (\n\t\twindow.matchMedia &&\n\t\twindow.matchMedia('(prefers-color-scheme: dark)').matches\n\t) {\n\t\tstorage.setItem('furretcss-theme', 'dark');\n\t\tstorage.setItem('furretcss-interacted', 'true');\n\t} else {\n\t\tstorage.setItem('furretcss-theme', 'none');\n\t}\n}\n\n/*\n * Function to manually toggle the theme.\n */\nwindow.furrets.themeToggle = function (toggleBtn) {\n\tconst themeToSet =\n\t\tstorage.getItem('furretcss-theme') === 'dark' ? 'light' : 'dark';\n\n\tloadColorScheme(themeToSet);\n\tstorage.setItem('furretcss-theme', themeToSet);\n\tif (toggleBtn) toggleBtn.innerText = themeToSet === 'light' ? '☀️' : '🌙';\n\n\treturn themeToSet;\n};\n\n/*\n * Function to initialize the theme and add a toggle to\n * the website.\n */\nwindow.furrets.addThemeToggle = function () {\n\tconst storedTheme = storage.getItem('furretcss-theme');\n\tconst themeToggle = document.createElement('button');\n\tthemeToggle.innerText = storedTheme === 'light' ? '☀️' : '🌙';\n\tthemeToggle.className = 'theme-toggle-btn';\n\tthemeToggle.addEventListener('click', () =>\n\t\twindow.furrets.themeToggle(themeToggle),\n\t);\n\n\tconst container = document.querySelector('body');\n\tcontainer.insertAdjacentElement('afterbegin', themeToggle);\n\n\tconst furretcssPath = new RegExp(\n\t\t'/furretcss/v2/full/(?:light|dark)(?:.min)?.css',\n\t);\n\tconst links = DOMRegex('link', 'href', furretcssPath);\n\n\tif (links.length === 0) {\n\t\tconsole.warn(\n\t\t\t'Warning: a full furretcss stylesheet was not found. Cannot choose stylesheet to preload.',\n\t\t);\n\t\treturn;\n\t}\n\n\tconst loadedTheme =\n\t\tlinks[0].href.split('/').pop().split('.')[0] === 'light'\n\t\t\t? 'light'\n\t\t\t: 'dark';\n\tconst themeToPreload = loadedTheme === 'light' ? 'dark' : 'light';\n\n\tconst preload = document.createElement('link');\n\tpreload.rel = 'preconnect';\n\tpreload.href = links[0].href.replace(loadedTheme, themeToPreload);\n\tpreload.as = 'text/css';\n\n\tlinks[0].after(preload);\n\n\tloadColorScheme(storedTheme);\n};\n"]}